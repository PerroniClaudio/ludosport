const o=(r,i)=>({eventid:r,eventPersonnel:[],filteredPersonnel:[],availableUsers:[],paginatedUsers:[],currentPage:1,pageSize:10,totalPages:0,searchAvailablesValue:"",searchPersonnelValue:"",getAvailableUsers:async function(){console.log("getAvailableUsers");const e=`${i=="admin"?"":"/"+i}/events/${this.eventid}/available-personnel`,s=await fetch(e);if(s.ok){const n=await s.json();this.eventPersonnel.length>0?this.availableUsers=n.filter(l=>!this.eventPersonnel.some(t=>t.id===l.id)):this.availableUsers=n}},getPersonnel:async function(){console.log("getPersonnel");const e=`${i=="admin"?"":"/"+i}/events/${this.eventid}/personnel`,s=await fetch(e);if(s.ok){const n=await s.json();this.eventPersonnel=n,this.filteredPersonnel=n,this.availableUsers.length>0&&(this.availableUsers=this.availableUsers.filter(l=>!this.eventPersonnel.some(t=>t.id===l.id)))}},searchAvailableUsers:function(e){console.log("searchAvailableUsers");let s=e.target.value;if(s.length===0){this.paginateAvailableUsers();return}this.paginatedUsers=this.availableUsers.filter(n=>n.name.toLowerCase().includes(s.toLowerCase())||n.surname.toLowerCase().includes(s.toLowerCase()))},searchPersonnel:function(e){console.log("searchPersonnel");let s=e.target.value;this.filteredPersonnel=this.eventPersonnel.filter(n=>n.name.toLowerCase().includes(s.toLowerCase())||n.surname.toLowerCase().includes(s.toLowerCase()))},addPersonnel:async function(e){console.log("addPersonnel");const s=this.availableUsers.find(a=>a.id===e);s&&this.eventPersonnel.push(s);let n=JSON.stringify(this.eventPersonnel.map(a=>a.id));const l=`${i=="admin"?"":"/"+i}/events/${this.eventid}/add-personnel`,t=new FormData;t.append("event_id",this.eventid),t.append("personnel",n),await fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:t}),this.availableUsers=this.availableUsers.filter(a=>a.id!==e),this.searchAvailablesValue="",this.paginateAvailableUsers(),this.searchPersonnelValue="",this.searchPersonnel({target:{value:""}})},removePersonnel:async function(e){console.log("removePersonnel"),console.log(this.eventPersonnel);const s=this.eventPersonnel.find(a=>a.id===e);s&&(this.eventPersonnel=this.eventPersonnel.filter(a=>a.id!==e));let n=JSON.stringify(this.eventPersonnel.map(a=>a.id));const l=`${i=="admin"?"":"/"+i}/events/${this.eventid}/add-personnel`,t=new FormData;t.append("event_id",this.eventid),t.append("personnel",n),await fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:t}),this.availableUsers.push(s),this.searchAvailablesValue="",this.paginateAvailableUsers(),this.searchPersonnelValue="",this.searchPersonnel({target:{value:""}})},savePersonnel:async function(){console.log("savePersonnel")},paginateAvailableUsers:function(){const e=(this.currentPage-1)*this.pageSize,s=e+this.pageSize;this.paginatedUsers=this.availableUsers.slice(e,s),this.totalPages=Math.ceil(this.availableUsers.length/this.pageSize)},goToPage:function(e){e>=1&&e<=this.totalPages&&(this.currentPage=e,this.paginateAvailableUsers())},init:async function(){await this.getAvailableUsers(),await this.getPersonnel(),this.paginateAvailableUsers()}});export{o as eventpersonnel};
