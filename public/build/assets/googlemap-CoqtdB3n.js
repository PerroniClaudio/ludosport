const e=i=>{const o=async t=>await(await fetch(`/events/location?location=${t}`)).json(),n=async t=>await(await fetch(`/events/coordinates?address=${t}`)).json();return{location:i||JSON.stringify({lat:0,lng:0}),city:"",address:"",postal_code:"",country:"",map:null,marker:null,init(){console.log(`googlemap init ${i}`),o(this.location).then(t=>{t.address_components.forEach(s=>{s.types.includes("route")&&(this.address=s.long_name+", "+this.address),s.types.includes("street_number")&&(this.address+=s.long_name),this.address===""&&s.types.includes("sublocality_level_2")&&(this.address=s.long_name),s.types.includes("locality")&&(this.city=s.long_name),this.city===""&&s.types.includes("postal_town")&&(this.city=s.long_name),this.city===""&&s.types.includes("administrative_area_level_2")&&(this.city=s.long_name),s.types.includes("country")&&(this.country=s.long_name),s.types.includes("postal_code")&&(this.postal_code=s.long_name)}),this.map=new google.maps.Map(document.getElementById("eventGoogleMap"),{center:t.geometry.location,zoom:15,height:"400px"}),this.marker=new google.maps.Marker({position:t.geometry.location,map:this.map})})},updateMap:function(){let t=this.address+", "+this.city+", "+this.postal_code+", "+this.country;n(t).then(s=>{this.map.setCenter(s),this.map.setZoom(15),this.marker!==null&&this.marker.setMap(null),this.marker=new google.maps.Marker({position:s,map:this.map}),this.location=JSON.stringify({lat:s.lat,lng:s.lng}),this.location=JSON.stringify(s)})}}};export{e as googlemap};
